<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"frezcirno.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.1.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":true,"nav":{"disqus":{"text":"Load Disqus","order":-1}},"activeClass":"disqus"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
<meta property="og:type" content="website">
<meta property="og:title" content="Frezcirno&#39;s Blog">
<meta property="og:url" content="https://frezcirno.github.io/page/8/index.html">
<meta property="og:site_name" content="Frezcirno&#39;s Blog">
<meta property="og:description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="frezcirno">
<meta property="article:tag" content="daily">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://frezcirno.github.io/page/8/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<title>Frezcirno's Blog</title>
  



  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Frezcirno's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">今天学到了什么？</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">48</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">11</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">108</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="frezcirno"
      src="https://cdn.7c00h.xyz/avatar.jpg">
  <p class="site-author-name" itemprop="name">frezcirno</p>
  <div class="site-description" itemprop="description">Frezcirno的个人博客, 记录一些技术相关的学习内容</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">108</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">48</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/frezcirno" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;frezcirno" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2277861660@qq.com" title="E-Mail → mailto:2277861660@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/daily/2020-12-18.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/daily/2020-12-18.html" class="post-title-link" itemprop="url">每日小结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-18 15:34:18" itemprop="dateCreated datePublished" datetime="2020-12-18T15:34:18+08:00">2020-12-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%AF%8F%E6%97%A5%E5%B0%8F%E7%BB%93-Day-Day-Up/" itemprop="url" rel="index"><span itemprop="name">每日小结 Day Day Up</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/daily/2020-12-18.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="daily/2020-12-18.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>52</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Oracle-Apex怎么调用procedure"><a href="#Oracle-Apex怎么调用procedure" class="headerlink" title="Oracle Apex怎么调用procedure"></a>Oracle Apex怎么调用procedure</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">begin</span></span><br><span class="line">  ANALYSIS(<span class="number">6</span>, <span class="number">1000</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/daily/2020-12-17.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/daily/2020-12-17.html" class="post-title-link" itemprop="url">每日小结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-18 00:27:04" itemprop="dateCreated datePublished" datetime="2020-12-18T00:27:04+08:00">2020-12-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%AF%8F%E6%97%A5%E5%B0%8F%E7%BB%93-Day-Day-Up/" itemprop="url" rel="index"><span itemprop="name">每日小结 Day Day Up</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/daily/2020-12-17.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="daily/2020-12-17.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Spring-doc-OpenAPI-注解"><a href="#Spring-doc-OpenAPI-注解" class="headerlink" title="Spring-doc OpenAPI 注解"></a>Spring-doc OpenAPI 注解</h1><p>@Operation<br>@Response<br>@Parameter</p>
<h1 id="Ubuntu设置代理"><a href="#Ubuntu设置代理" class="headerlink" title="Ubuntu设置代理"></a>Ubuntu设置代理</h1><p>启动clash for linux</p>
<ul>
<li><p>配置代理地址配置文件</p>
</li>
<li><p>配置restAPI地址和访问密码</p>
</li>
<li><p>将clash作为一个daemon进程:</p>
<ul>
<li><p>使用systemd:</p>
<p>  先创建配置文件<code>/etc/systemd/system/clash.service</code></p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Clash Daemon</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/bin/clash -d /etc/clash/</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>
<p>  然后clash就成为了一个service, 可以通过systemctl命令启动, 通过journalctl命令查看日志等</p>
</li>
<li><p>使用pm2: <code>pm2 start clash</code></p>
</li>
</ul>
</li>
<li><p>在.bashrc或者.zshrc文件底部设置</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> all_proxy=<span class="string">&#x27;socks5://localhost:7891&#x27;</span></span><br><span class="line"><span class="built_in">export</span> http_proxy=<span class="string">&#x27;http://localhost:7890&#x27;</span></span><br><span class="line"><span class="built_in">export</span> https_proxy=<span class="string">&#x27;http://localhost:7890&#x27;</span></span><br><span class="line"><span class="built_in">export</span> ftp_proxy=<span class="string">&#x27;http://localhost:7890&#x27;</span></span><br><span class="line"><span class="built_in">export</span> no_proxy=<span class="string">&#x27;localhost,127.0.0.1&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="Shell的类型"><a href="#Shell的类型" class="headerlink" title="Shell的类型"></a>Shell的类型</h1><h2 id="shell的类型"><a href="#shell的类型" class="headerlink" title="shell的类型"></a>shell的类型</h2><p>常见的shell有sh, bash, zsh等, </p>
<p>查看当前使用的shell: <code>echo $SHELL</code></p>
<p>查看系统中的所有shell: <code>cat /etc/shells</code></p>
<h2 id="登录shell和非登录shell"><a href="#登录shell和非登录shell" class="headerlink" title="登录shell和非登录shell"></a>登录shell和非登录shell</h2><h2 id="交互式shell和非交互式shell"><a href="#交互式shell和非交互式shell" class="headerlink" title="交互式shell和非交互式shell"></a>交互式shell和非交互式shell</h2><h2 id="profile-和-xxshrc"><a href="#profile-和-xxshrc" class="headerlink" title=".profile 和 .xxshrc"></a>.profile 和 .xxshrc</h2><ul>
<li><p>/etc/profile 为系统的每个用户设置环境信息,当第一个用户登录时, 该文件被执行, 并从/etc/profile.d目录的配置文件中搜集shell的设置</p>
</li>
<li><p>/etc/xxshrc 为每一个运行xx shell的用户执行此文件. 当xx shell被打开时, 该文件被读取。有些linux版本中的/etc目录下已经没有了该文件。</p>
</li>
<li><p>~/.profile 每个用户都可使用该文件输入专用于自己使用的shell信息, 当用户登录时,该文件仅仅执行一次 默认情况下,它设置一些环境变量,然后执行用户的.xxshrc文件.</p>
</li>
<li><p>~/.xxshrc 该文件包含专用于某个用户的xx shell的配置, 当该用户登录时以及每次打开新的xx shell时,该文件被读取.</p>
</li>
</ul>
<h1 id="Hexo-layout"><a href="#Hexo-layout" class="headerlink" title="Hexo layout"></a>Hexo layout</h1><p>hexo中每种不同的页面样式称为一个layout</p>
<p>根据md放置的位置不同, 使用的layout也不同</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/compiler-principle/codegen.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/compiler-principle/codegen.html" class="post-title-link" itemprop="url">目标代码生成</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-17 10:56:11" itemprop="dateCreated datePublished" datetime="2020-12-17T10:56:11+08:00">2020-12-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">编译原理</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/compiler-principle/codegen.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="compiler-principle/codegen.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="目标代码生成"><a href="#目标代码生成" class="headerlink" title="目标代码生成"></a>目标代码生成</h1><h2 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h2><pre><code>中间代码 --&gt; 代码生成器 --&gt; 目标程序
                ^
                |
            符号表
</code></pre><h2 id="目标代码的三种形式"><a href="#目标代码的三种形式" class="headerlink" title="目标代码的三种形式:"></a>目标代码的三种形式:</h2><ol>
<li>能立即执行的机器码(所有地址已经定位)</li>
<li>待装配的机器语言模块(连接装入后即可执行)</li>
<li>汇编语言代码(经汇编程序汇编后即可执行)</li>
</ol>
<p>此处选择汇编语言</p>
<h2 id="目标机器模型"><a href="#目标机器模型" class="headerlink" title="目标机器模型"></a>目标机器模型</h2><p>此处假设目标计算机:</p>
<ol>
<li>具有多个通用寄存器, 可以用来运算, 也可以用来取地址</li>
<li>支持四种指令形式<ol>
<li>直接地址型 <code>OP R, M</code> - <code>R OP M =&gt; R</code></li>
<li>寄存器型 <code>OP Ri, Rj</code> - <code>Ri OP Rj =&gt; Ri</code></li>
<li>变址型 <code>OP Ri, c(Rj)</code> - <code>Ri OP (Rj+c) =&gt; Ri</code></li>
<li>间接型<ol>
<li><code>OP Ri, (M)</code> - <code>R OP (M) =&gt; R</code></li>
<li><code>OP Ri, (Rj)</code> - <code>Ri OP (Rj) =&gt; Ri</code></li>
<li><code>OP Ri, (c(Rj))</code> - <code>Ri OP ((Rj+c)) =&gt; Ri</code></li>
</ol>
</li>
</ol>
</li>
</ol>
<p>OP可以是ADD,SUB,MUL,DIV等</p>
<h2 id="简单代码生成器"><a href="#简单代码生成器" class="headerlink" title="简单代码生成器"></a>简单代码生成器</h2><p>思路: 代码生成器在生成每一条指令时, 必须要知道每个寄存器中存储的是什么, 以及每个变量存储到什么位置<br>方法: </p>
<ol>
<li>引入<strong>待用信息</strong></li>
<li>寄存器描述数组</li>
<li>变量地址描述数组</li>
</ol>
<h2 id="待用信息"><a href="#待用信息" class="headerlink" title="待用信息"></a>待用信息</h2><p>待用信息</p>
<ul>
<li>在基本块中, 四元式i对A定值, 四元式j对A取值, 且i,j之间无再对A定值, 则称j是i的变量A的待用信息</li>
</ul>
<p>活跃信息</p>
<ul>
<li>基本块中的一个名字在某个给定点之后仍被引用, 则称该名字在给定点是活跃的</li>
</ul>
<p>修改符号表</p>
<ul>
<li>记录待用信息和活跃信息</li>
<li><p>表示: (<code>待用信息[i/^]</code>,<code>活跃信息[y/^]</code>)</p>
<p>| 变量名 | 待用/活跃信息栏 |<br>| ——— | ———————- |<br>| A      | (…, …)      |<br>| B      | (…, …)      |<br>| …    | (…, …)      |</p>
</li>
</ul>
<p>计算待用和活跃信息</p>
<ol>
<li>开始时, 所有变量均为<code>非待用</code>, 根据基本块之后是否活跃填写<code>活跃</code>或<code>非活跃</code></li>
<li>逆序遍历每个四元式<code>i</code><ol>
<li>把<code>A</code>的引用信息附加到四元式<code>i</code>左值上</li>
<li><code>A</code>的引用信息附加<code>(^,^)</code></li>
<li>把<code>B</code>,<code>C</code>的引用信息附加到四元式<code>i</code>上</li>
<li><code>B</code>,<code>C</code>的引用信息附加<code>(^,^)</code></li>
</ol>
</li>
</ol>
<p>例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">T1:&#x3D;B-C</span><br><span class="line">T2:&#x3D;A*T1</span><br><span class="line">T3:&#x3D;D+1</span><br><span class="line">T4:&#x3D;E-F</span><br><span class="line">T5:&#x3D;T3*T4</span><br><span class="line">W:&#x3D;T2&#x2F;T5</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>序号</th>
<th>四元式</th>
<th>左值</th>
<th>左操作数</th>
<th>右操作数</th>
</tr>
</thead>
<tbody>
<tr>
<td>(6)</td>
<td>W:=T2/T5</td>
<td>(^,y)</td>
<td>(^,^)</td>
<td>(^,^)</td>
</tr>
<tr>
<td>(5)</td>
<td>T5:=T3*T4</td>
<td>(6,y)</td>
<td>(^,^)</td>
<td>(^,^)</td>
</tr>
<tr>
<td>(4)</td>
<td>T4:=E-F</td>
<td>(3,y)</td>
<td>(^,^)</td>
<td>(^,^)</td>
</tr>
<tr>
<td>(3)</td>
<td>T3:=D+1</td>
<td>(3,y)</td>
<td>(^,^)</td>
<td>(^,^)</td>
</tr>
<tr>
<td>(2)</td>
<td>T2:=A*T1</td>
<td>(6,y)</td>
<td>(^,^)</td>
<td>(^,^)</td>
</tr>
<tr>
<td>(1)</td>
<td>T1:=B-C</td>
<td>(2,y)</td>
<td>(^,^)</td>
<td>(^,^)</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>变量名</th>
<th>待用/活跃信息栏</th>
</tr>
</thead>
<tbody>
<tr>
<td>T5</td>
<td>(^,^)-&gt;(6,y)-&gt;(^,^)</td>
</tr>
<tr>
<td>T4</td>
<td>(^,^)-&gt;(3,y)-&gt;(^,^)</td>
</tr>
<tr>
<td>T3</td>
<td>(^,^)-&gt;(3,y)-&gt;(^,^)</td>
</tr>
<tr>
<td>T2</td>
<td>(^,^)-&gt;(6,y)-&gt;(^,^)</td>
</tr>
<tr>
<td>T1</td>
<td>(^,^)-&gt;(2,y)-&gt;(^,^)</td>
</tr>
<tr>
<td>W</td>
<td>(^,y)-&gt;(^,^)</td>
</tr>
<tr>
<td>F</td>
<td>(^,^)-&gt;(4,y)</td>
</tr>
<tr>
<td>E</td>
<td>(^,^)-&gt;(4,y)</td>
</tr>
<tr>
<td>D</td>
<td>(^,^)-&gt;(3,y)</td>
</tr>
<tr>
<td>C</td>
<td>(^,^)-&gt;(1,y)</td>
</tr>
<tr>
<td>B</td>
<td>(^,^)-&gt;(1,y)</td>
</tr>
<tr>
<td>A</td>
<td>(^,^)-&gt;(2,y)</td>
</tr>
</tbody>
</table>
</div>
<h2 id="寄存器分配算法"><a href="#寄存器分配算法" class="headerlink" title="寄存器分配算法"></a>寄存器分配算法</h2><p>寄存器描述和地址描述</p>
<ul>
<li>寄存器描述数组<code>RVALUE</code><ul>
<li>记录寄存器内存储的变量, 可以是多个</li>
<li><code>RVALUE[R1]=&#123;A,B&#125;</code></li>
</ul>
</li>
<li>变量地址描述数组<code>AVALUE</code><ul>
<li>记录变量存储的位置(寄存器/内存)</li>
<li><code>AVALUE[A]=&#123;R1,R2,A&#125;</code></li>
</ul>
</li>
</ul>
<p>代码生成算法</p>
<ul>
<li>对于四元式<code>A:=B op C</code>, 依次执行</li>
</ul>
<ol>
<li>调用<code>GETREG(i: A:=B op C)</code>获取一个寄存器<code>R</code></li>
<li>查询<code>AVALUE[B]</code>和<code>AVALUE[C]</code>, 如果在寄存器中, 假设是<code>B&#39;</code>和<code>C&#39;</code></li>
<li>如果<code>B&#39;≠R</code>, 先把<code>B</code>加载到<code>R</code>中, 生成代码: <code>LD R,B&#39;</code></li>
<li>进行运算, 生成代码: <code>op R,C&#39;</code></li>
<li>更新描述信息<ol>
<li>如果<code>B&#39;</code>或<code>C&#39;</code>是<code>R</code>, 就要把<code>AVALUE</code>中的记录删除</li>
<li>设置<code>AVALUE[A]=&#123;R&#125;, RVALUE[R]=&#123;A&#125;</code></li>
</ol>
</li>
<li>如果<code>B</code>或<code>C</code>仍存储在某个寄存器中, 但后续不再被引用且不再活跃, 就从<code>AVALUE</code>和<code>RVALUE</code>中删除<code>B</code>和<code>C</code>的记录</li>
</ol>
<p>寄存器分配原则</p>
<ul>
<li>尽可能用B独占的寄存器</li>
<li>尽可能用空闲的寄存器</li>
<li>抢占用非空闲寄存器<ul>
<li><code>Ri</code>的值也存储在内存中</li>
<li><code>Ri</code>最远才会用到</li>
</ul>
</li>
</ul>
<p>寄存器分配算法<code>GETREG(i: A:=B op C)</code></p>
<ol>
<li>如果B独占某个寄存器<ul>
<li>如果<code>AB</code>是同一个标识符(即修改B的指令<code>B:=B op C</code>)<ul>
<li>返回<code>B</code>所在的寄存器</li>
</ul>
</li>
<li>如果<code>B</code>在后面不会再引用(非待用, 非活跃)<ul>
<li>返回<code>B</code>所在的寄存器</li>
</ul>
</li>
</ul>
</li>
<li>如果有空闲寄存器, 返回空闲寄存器</li>
<li>抢占一个寄存器<code>Ri</code>, <ol>
<li>对于<code>Ri</code>中存储的每一个变量<code>M</code>, 如果存储的不是<code>A</code>, 或者存储的是<code>A == C != B</code>且<code>Ri</code>中不存储<code>B</code>.(<code>M==A &amp;&amp; M==C &amp;&amp; M!=B &amp;&amp; B not in RVALUE[Ri]</code>)<ol>
<li>如果<code>M</code>仅存储在<code>Ri</code>, 则要存到内存中: <code>ST Ri, M</code></li>
<li>如果<code>M == B</code>, 或者<code>M == C &amp;&amp; B in RVALUE[Ri]</code>中, 则令<code>AVALUE[M]=&#123;M,R&#125;</code>, 否则令<code>AVALUE[M]=&#123;M&#125;</code></li>
<li>删除<code>M</code>在<code>Ri</code>中的记录, <code>RVALUE[Ri].reLD e(M)</code></li>
<li>返回<code>R</code></li>
</ol>
</li>
</ol>
</li>
</ol>
<p>例:</p>
<p>寄存器: R0, R1, </p>
<p>基本块出口活跃变量: W</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">T1:&#x3D;B-C</span><br><span class="line">T2:&#x3D;A*T1</span><br><span class="line">T3:&#x3D;D+1</span><br><span class="line">T4:&#x3D;E-F</span><br><span class="line">T5:&#x3D;T3*T4</span><br><span class="line">W:&#x3D;T2&#x2F;T5</span><br></pre></td></tr></table></figure>
<p>答案:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">【解答】该基本块的目标代码如下(指令后面为相应的注释)：</span><br><span class="line">LD  R0, B  <span class="comment">/* 取第一个空闲寄存器 R0 */</span> </span><br><span class="line">SUB R0, C  <span class="comment">/* 运算结束后R0中为T1结果，内存中无该结果 */</span> </span><br><span class="line">LD  R1, A  <span class="comment">/* 取一个空闲寄存器R1 */</span> </span><br><span class="line">MUL R1, R0 <span class="comment">/* 运算结束后R1中为T2结果，内存中无该结果 */</span> </span><br><span class="line">LD  R0,D  <span class="comment">/* 此时R0中结果T1已经没有引用点，且临时单元T1是非活跃的，所以，寄存器R0可作为空闲寄存器使用 */</span> </span><br><span class="line">ADD R0, <span class="number">1</span> <span class="comment">/* 运算结束后R0中为T3结果，内存中无该结果 */</span> </span><br><span class="line">ST  R1, T2  <span class="comment">/*翻译四元式T4=E-F时，所有寄存器已经分配完毕，寄存器R0中存的T3和寄存器R1中存的T2都是有用的。由于T2的下一个引用点较T3的下一个引用点更远，所以暂时可将寄存器R1中的结果存回到内存的变量T2中，从而将寄存器R1空闲以备使用*/</span> </span><br><span class="line">LD  R1, E     </span><br><span class="line">SUB R1, F  <span class="comment">/*运算结束后R1中为T4结果，内存中无该结果*/</span>  </span><br><span class="line">MUL R0, R1 <span class="comment">/*运算结束后R0中为T5结果，内存中无该结果。注意，该指令将寄存器R0中原来的结果T3冲掉了。可以这么做的原因是，T3在该指令后不再有引用点，且是非活跃变量*/</span> </span><br><span class="line">LD  R1, T2 <span class="comment">/*此时R1中结果T4已经没有引用点，且临时单元T4是非活跃的，因此寄存器R1可作为空闲寄存器使用*/</span> </span><br><span class="line">DIV R1, R0  </span><br><span class="line"><span class="comment">/*运算结束后R1中为W结果，内存中无该结果。此时所有指令部分已经翻译完毕*/</span> </span><br><span class="line">ST  R1, W </span><br><span class="line"><span class="comment">/*指令翻译完毕时，寄存器中存有最新的计算结果，必须将它们存回到内存相应的单元中去，否则，在翻译下一个基本块时，所有的寄存器被当成空闲的寄存器使用，从而造成计算结果的丢失。考虑到寄存器R0中的T5和寄存器R1中的W，临时单元T5是非活跃的，因此只要将结果W存回对应单元即可*/</span> </span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/compiler-principle/profile.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/compiler-principle/profile.html" class="post-title-link" itemprop="url">优化</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-17 10:56:07" itemprop="dateCreated datePublished" datetime="2020-12-17T10:56:07+08:00">2020-12-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">编译原理</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/compiler-principle/profile.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="compiler-principle/profile.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>934</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="提纲"><a href="#提纲" class="headerlink" title="提纲"></a>提纲</h2><p><img src="profile/index.png" alt=""></p>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>优化：对程序进行各种等价变换，使得从变换后的程序出发，能生成更有效的目标代码。</p>
<p>原则</p>
<ul>
<li>等价</li>
<li>有效</li>
<li>合算</li>
</ul>
<p>级别</p>
<ul>
<li>局部优化</li>
<li>循环优化</li>
<li>全局优化</li>
</ul>
<p>种类</p>
<ul>
<li>删除公用子表达式</li>
<li>复写传播</li>
<li>删除无用赋值</li>
<li>代码外提</li>
<li>强度削弱</li>
<li>变换循环控制条件</li>
<li>合并已知量</li>
</ul>
<h2 id="局部优化"><a href="#局部优化" class="headerlink" title="局部优化"></a>局部优化</h2><h3 id="基本块"><a href="#基本块" class="headerlink" title="基本块"></a>基本块</h3><p>基本块</p>
<ul>
<li>指程序中一顺序执行语句序列，其中只有一个入口和一个出口。入口就是其中第一个语句，出口就是其中最后一个语句。</li>
</ul>
<p>活跃</p>
<ul>
<li>基本块中的一个名字在某个给定点之后仍被引用, 则称该名字在给定点是活跃的</li>
</ul>
<p>局部优化</p>
<ul>
<li>局限在基本块范围内的优化</li>
</ul>
<p>划分基本块</p>
<ul>
<li>基本块入口<ul>
<li>程序第一条语句</li>
<li><strong>能</strong>转移到的语句</li>
<li>转移语句后面的语句</li>
</ul>
</li>
<li>基本块的出口(包括)<ul>
<li>基本块入口的前一条语句</li>
<li>转移语句(包括)</li>
<li>停语句(包括)</li>
</ul>
</li>
<li>不在基本块中的语句可以从程序中删除</li>
</ul>
<p><img src="profile/basic_block.png" alt=""></p>
<p>基本块中的优化</p>
<ul>
<li>删除公用子表达式</li>
<li>删除无用赋值</li>
<li>合并已知量: <code>T1=2; T2=4*T1;</code> =&gt; <code>T2=8;</code></li>
<li>临时变量改名</li>
<li>交换语句的位置</li>
<li>代数变换: 删除<code>x=x+0; x=x*1;</code>, <code>x=y^2;</code> =&gt; <code>x=y*y;</code></li>
</ul>
<h3 id="流图"><a href="#流图" class="headerlink" title="流图"></a>流图</h3><ul>
<li>把基本块编号后按执行顺序连接成一张图</li>
<li>入口语句是流图的首结点</li>
</ul>
<p>前驱和后继</p>
<ul>
<li>在程序序列中, 若A,B相邻而且A最后一条语句不是无条件跳转, 则称A是B的前驱, B为A的后继</li>
</ul>
<p><img src="profile/program_flow.png" alt=""></p>
<h3 id="基本块的DAG表示"><a href="#基本块的DAG表示" class="headerlink" title="基本块的DAG表示"></a>基本块的DAG表示</h3><ul>
<li>用带有标记或附加信息的DAG来表示变量间的关系</li>
<li>叶结点: 以<strong>标识符或常数</strong>作为标记</li>
<li>内部结点: 以<strong>运算符</strong>作为标记</li>
<li>每个结点可以有<strong>附加标识符</strong>: 表示附加标识符具有相同的值</li>
</ul>
<h3 id="基本块的DAG优化算法"><a href="#基本块的DAG优化算法" class="headerlink" title="基本块的DAG优化算法"></a>基本块的DAG优化算法</h3><p>基本块代码分类</p>
<ul>
<li>0型: 单纯赋值语句<code>A:=B</code></li>
<li>1型: 一元运算赋值<code>A:=op B</code></li>
<li>2型: 二元运算赋值<code>A:=B op C</code>/数组取值赋值<code>A:=B[C]</code></li>
</ul>
<p>对基本块中每一四元式，依次执行以下步骤:</p>
<ol>
<li>如果是0型, 记<code>NODE(B)</code>的值为<code>n</code>, 转4</li>
<li>如果存在任意一个操作数无定义, 则构造该操作数结点</li>
<li>如果所有操作数都是常数<ol>
<li>如果<code>NODE(B)</code>(或<code>NODE(C)</code>)是新构造的结点, 删除</li>
<li>计算<code>op</code>, 记为<code>P</code></li>
<li>如果<code>NODE(P)</code>无定义, 构造之, 记为<code>n</code></li>
</ol>
</li>
<li>否则<ol>
<li>检查DAG中是否已经存在结点<code>op</code>, 如果没有则构造之, 记为<code>n</code></li>
</ol>
</li>
<li>删除无用赋值<ol>
<li>如果<code>A</code>已经在某个结点处定义, 删除之, 把<code>A</code>附在<code>n</code>结点上, 令<code>NODE(A)=n</code></li>
</ol>
</li>
</ol>
<p>DAG优化算法</p>
<ul>
<li>执行上述算法</li>
<li>在基本块外被定值的标识符作为叶子结点上的标识符</li>
<li>在基本块内被定值且在基本块后被引用的标识符作为结点上的附加标识符</li>
</ul>
<h2 id="循环优化"><a href="#循环优化" class="headerlink" title="循环优化"></a>循环优化</h2><p>不考, 略</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/compiler-principle/ir.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/compiler-principle/ir.html" class="post-title-link" itemprop="url">语义分析和中间代码生成</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-17 10:55:55" itemprop="dateCreated datePublished" datetime="2020-12-17T10:55:55+08:00">2020-12-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">编译原理</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/compiler-principle/ir.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="compiler-principle/ir.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="提纲"><a href="#提纲" class="headerlink" title="提纲"></a>提纲</h1><p><img src="ir/index1.png" alt=""></p>
<p><img src="ir/index2.png" alt=""></p>
<h1 id="属性文法和语法制导翻译"><a href="#属性文法和语法制导翻译" class="headerlink" title="属性文法和语法制导翻译"></a>属性文法和语法制导翻译</h1><h2 id="属性文法"><a href="#属性文法" class="headerlink" title="属性文法"></a>属性文法</h2><p>属性文法: 在上下文无关文法的基础上给每个文法符号增加若干属性</p>
<p>语义规则: 对于文法的每个产生式配备了<strong>一组</strong>属性的计算规则</p>
<ul>
<li>$b:=f(c_1,c_2,…,c_k)$</li>
<li>产生式左边的综合属性和右边的继承属性必须提供语义规则</li>
<li>语义规则所描述的工作可以包括属性计算、符号表操作、静态语义检查、代码生成等等。</li>
</ul>
<p>属性加工的过程即是语义处理的过程</p>
<p>属性</p>
<ul>
<li>综合属性: 在语法树中, 通过子节点的属性计算出来的属性(自下而上)</li>
<li>继承属性: 在语法树中, 通过父节点和兄弟节点的属性计算出来的属性(自上而下)</li>
<li>终结符只有综合属性, 有lexer提供</li>
</ul>
<h3 id="S-属性文法"><a href="#S-属性文法" class="headerlink" title="S-属性文法"></a>S-属性文法</h3><p>只包含综合属性的文法</p>
<h3 id="L-属性文法"><a href="#L-属性文法" class="headerlink" title="L-属性文法"></a>L-属性文法</h3><p>如果每个产生式A→X1…Xj-1Xj…Xn的每条语义规则计算的属性或者是A的综合属性；或者是Xj的继承属性，但它仅依赖：</p>
<ul>
<li>该产生式中Xj左边符号X1, X2, …, Xj-1的属性；</li>
<li>A的继承属性</li>
</ul>
<h2 id="语法制导翻译"><a href="#语法制导翻译" class="headerlink" title="语法制导翻译"></a>语法制导翻译</h2><p>语法制导翻译法: </p>
<ul>
<li>基于属性文法的处理过程: <code>输入串-&gt;语法树-&gt;依赖图-&gt;语义规则计算次序</code></li>
<li>由源程序的语法结构所驱动</li>
</ul>
<p>作用</p>
<ul>
<li><strong>产生中间代码</strong></li>
<li>产生目标指令</li>
<li>对输入串进行解释执行</li>
</ul>
<h3 id="依赖图"><a href="#依赖图" class="headerlink" title="依赖图"></a>依赖图</h3><p>用DAG表示属性依赖关系</p>
<ul>
<li>每个属性一个结点</li>
<li>语义规则中左边属性依赖右边每一个属性</li>
</ul>
<p><img src="ir/dep_tree.png" alt=""></p>
<ol>
<li><p>树遍历法</p>
<ul>
<li>无环图</li>
<li>DFS</li>
<li>从左到右</li>
</ul>
</li>
<li><p>一遍扫描法</p>
<ul>
<li>在语法分析的同时计算属性值</li>
<li>S-属性文法适合于一遍扫描的自下而上分析</li>
<li>L-属性文法适合于一遍扫描的自上而下分析</li>
</ul>
</li>
</ol>
<h1 id="语义分析和中间代码生成"><a href="#语义分析和中间代码生成" class="headerlink" title="语义分析和中间代码生成"></a>语义分析和中间代码生成</h1><h2 id="语义分析"><a href="#语义分析" class="headerlink" title="语义分析"></a>语义分析</h2><h2 id="中间语言"><a href="#中间语言" class="headerlink" title="中间语言"></a>中间语言</h2><p>中间语言是复杂性界于源语言和目标语言之间的语言</p>
<p>好处:</p>
<ul>
<li>便于进行与机器无关的代码优化工作</li>
<li>易于移植</li>
<li>使编译程序的结构在逻辑上更为简单明确</li>
</ul>
<p>常用的中间语言表示法</p>
<ul>
<li>后缀式(逆波兰式)</li>
<li>图表示<ul>
<li>DAG</li>
<li>AST</li>
</ul>
</li>
<li>三地址代码<ul>
<li>三元式</li>
<li>四元式</li>
<li>间接三元式</li>
</ul>
</li>
</ul>
<p>后缀式:</p>
<ul>
<li>二元操作符后置</li>
<li>(一元操作符后置)</li>
<li>去括号</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a+b*(c+d&#x2F;e)</span><br><span class="line">a b*(c+d&#x2F;e) +</span><br><span class="line">a b (c+d&#x2F;e) * +</span><br><span class="line">a b c d&#x2F;e + * +</span><br><span class="line">a b c d e &#x2F; + * +</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">b:&#x3D;-c*a+-c*a</span><br><span class="line">b -c*a+-c*a :&#x3D;</span><br><span class="line">b -c*a -c*a + :&#x3D;</span><br><span class="line">b -c a * -c a * + :&#x3D;</span><br><span class="line">b c Neg a * c Neg a * + :&#x3D;</span><br></pre></td></tr></table></figure>
<p>抽象语法树: 去掉对翻译不必要的信息, 更有效表示源程序的语法树</p>
<p><img src="ir/ast.png" alt=""></p>
<p>DAG</p>
<ul>
<li>一个内部结点代表一个操作符，它的孩子代表操作数</li>
<li>一个DAG中代表<strong>公共子表达式</strong>的结点具有多个父结点</li>
</ul>
<p><img src="ir/dag.png" alt=""></p>
<p>三地址代码: <code>x:=y op z</code></p>
<ul>
<li>三地址代码可以看成是抽象语法树或DAG的一种线性表示</li>
<li>种类<ul>
<li><code>x:=y op z</code></li>
<li><code>x:=op y</code></li>
<li><code>x:=y</code></li>
<li><code>goto L</code></li>
<li><code>if x rop y goto L</code></li>
<li><code>if a goto L</code></li>
</ul>
</li>
<li><p>计算机表示</p>
<ul>
<li><p>四元式</p>
<p>|     | Op     | arg1 | arg2 | result |<br>| —- | ——— | —— | —— | ——— |<br>| (0) | uminus | c    |      | T1     |<br>| (1) | *      | b    | T1   | T2     |<br>| … | …    | …  | …  | …    |</p>
</li>
<li><p>三元式</p>
<p>|     | Op     | arg1 | arg2 |<br>| —- | ——— | —— | —— |<br>| (0) | uminus | c    |      |<br>| (1) | *      | b    | (0)  |<br>| … | …    | …  | …  |<br>| (4) | +      | (1)  | (3)  |<br>| … | …    | …  | …  |</p>
</li>
<li><p>间接三元式</p>
<ul>
<li>使用间接代码表来压缩存储相同的三元式</li>
<li>好处: <ul>
<li>调整语句顺序不需要改动三元式表</li>
<li>节省存储空间</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="说明语句的翻译"><a href="#说明语句的翻译" class="headerlink" title="说明语句的翻译"></a>说明语句的翻译</h2><h2 id="赋值语句的翻译"><a href="#赋值语句的翻译" class="headerlink" title="赋值语句的翻译"></a>赋值语句的翻译</h2><p><img src="ir/assign_example.png" alt=""></p>
<p>答案:</p>
<p><img src="ir/assign_example_solution.png" alt=""></p>
<p>三地址代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">T1:&#x3D;uminus C</span><br><span class="line">T2:&#x3D;T1+D</span><br><span class="line">T3:&#x3D;B*T2</span><br><span class="line">A:&#x3D;T3</span><br></pre></td></tr></table></figure></p>
<h2 id="布尔表达式的翻译"><a href="#布尔表达式的翻译" class="headerlink" title="布尔表达式的翻译"></a>布尔表达式的翻译</h2><p>基本作用:</p>
<ul>
<li>逻辑运算</li>
<li>控制语句条件</li>
</ul>
<p>翻译方法</p>
<ul>
<li>算数方式</li>
<li>短路计算</li>
</ul>
<h3 id="逻辑运算中的布尔表达式翻译"><a href="#逻辑运算中的布尔表达式翻译" class="headerlink" title="逻辑运算中的布尔表达式翻译"></a>逻辑运算中的布尔表达式翻译</h3><p><img src="ir/bool_example.png" alt=""></p>
<p>答案:</p>
<p>三地址代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0: if a&gt;b goto 3</span><br><span class="line">1: T1:&#x3D;0</span><br><span class="line">2: goto 4</span><br><span class="line">3: T1:&#x3D;1</span><br><span class="line">4: if a&gt;b goto 7</span><br><span class="line">5: T1:&#x3D;0</span><br><span class="line">6: goto 8</span><br><span class="line">7: T1:&#x3D;1</span><br><span class="line">8: T3&#x3D;T1 and T2</span><br></pre></td></tr></table></figure></p>
<h3 id="条件控制语句中的布尔表达式翻译"><a href="#条件控制语句中的布尔表达式翻译" class="headerlink" title="条件控制语句中的布尔表达式翻译"></a>条件控制语句中的布尔表达式翻译</h3><p>两种出口: 一真一假</p>
<p>改写产生式</p>
<ul>
<li><code>E -&gt; E and M E</code></li>
<li><code>E -&gt; E or M E</code></li>
<li><code>M -&gt; epsilon</code></li>
</ul>
<p>增加属性</p>
<ul>
<li><code>truelist</code>/<code>falselist</code>: 布尔表达式中需要回填地址的四元式构成的(反向)列表, 从最后的需要回填地址四元式指向更靠前的四元式</li>
<li><code>nextquad</code>: 下一条即将产生的四元式的地址, 如果是emit过程中包含那么就是该条语句的地址</li>
</ul>
<p>增加过程</p>
<ul>
<li><code>makelist(i)</code>: 创建一个新链表<code>-&gt;i</code></li>
<li><code>merge(p1,p2)</code>: 合并两个链表</li>
<li><code>backpatch(p,t)</code>: 回填地址</li>
</ul>
<p><img src="ir/bool1.png" alt=""></p>
<p><img src="ir/bool2.png" alt=""></p>
<p>例: 写出布尔式A or (B and not (C or D))的四元式序列</p>
<p>答案:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0: jnz,A,-,0</span><br><span class="line">1: j,-,-,2</span><br><span class="line">2: jnz,B,-,4</span><br><span class="line">3: j,-,-,0</span><br><span class="line">4: jnz,C,-,0</span><br><span class="line">5: j,-,-,6</span><br><span class="line">6: jnz,D,-,0</span><br><span class="line">7: j,-,-,0</span><br></pre></td></tr></table></figure>
<h2 id="控制语句的翻译"><a href="#控制语句的翻译" class="headerlink" title="控制语句的翻译"></a>控制语句的翻译</h2><h3 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h3><p>改写产生式</p>
<ul>
<li><code>S -&gt; if E then M S</code></li>
<li><code>S -&gt; if E then M S N else M S</code></li>
<li><code>M -&gt; epsilon</code></li>
<li><code>N -&gt; epsilon</code></li>
</ul>
<p>增加属性:</p>
<ul>
<li><code>nextlist</code>: 下一条执行语句的地址, 引入此变量是为了优化连续多次跳转</li>
</ul>
<p><img src="ir/control.png" alt=""></p>
<h3 id="循环语句-while"><a href="#循环语句-while" class="headerlink" title="循环语句(while)"></a>循环语句(while)</h3><p><img src="ir/while.png" alt=""></p>
<h3 id="语句列表和语句块"><a href="#语句列表和语句块" class="headerlink" title="语句列表和语句块"></a>语句列表和语句块</h3><p>改写产生式</p>
<ul>
<li><code>L -&gt; L; M S</code></li>
<li><code>M -&gt; epsilon</code></li>
</ul>
<p><img src="ir/list.png" alt=""></p>
<p><img src="ir/block.png" alt=""></p>
<h3 id="标号与goto语句的翻译"><a href="#标号与goto语句的翻译" class="headerlink" title="标号与goto语句的翻译"></a>标号与goto语句的翻译</h3><h3 id="case语句的翻译"><a href="#case语句的翻译" class="headerlink" title="case语句的翻译"></a>case语句的翻译</h3><h2 id="过程调用的翻译"><a href="#过程调用的翻译" class="headerlink" title="过程调用的翻译"></a>过程调用的翻译</h2><p>不考, 略</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/compiler-principle/parser.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/compiler-principle/parser.html" class="post-title-link" itemprop="url">语法分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-17 10:54:20" itemprop="dateCreated datePublished" datetime="2020-12-17T10:54:20+08:00">2020-12-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">编译原理</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/compiler-principle/parser.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="compiler-principle/parser.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="提纲"><a href="#提纲" class="headerlink" title="提纲"></a>提纲</h2><p><img src="parser/index1.png" alt=""></p>
<p><img src="parser/index2.png" alt=""></p>
<h2 id="语法分析方法"><a href="#语法分析方法" class="headerlink" title="语法分析方法"></a>语法分析方法</h2><ul>
<li>自上而下分析<ul>
<li>LL(1)分析法</li>
<li>递归下降分析法</li>
<li>预测分析法</li>
</ul>
</li>
<li>自下而上分析<ul>
<li>算符优先分析法</li>
<li>LR分析法<ul>
<li>LR(0)</li>
<li>SLR</li>
<li>LR(1)</li>
<li>LALR</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="LL-1"><a href="#LL-1" class="headerlink" title="LL(1)"></a>LL(1)</h2><h3 id="左递归消除"><a href="#左递归消除" class="headerlink" title="左递归消除"></a>左递归消除</h3><p>一个文法含有下列形式的产生式时, 称为左递归文法, 不能采用自顶向下分析法</p>
<ol>
<li><p>直接递归</p>
<p> $A\rightarrow A\beta, A\in V_N$, $\beta$$\in$V*</p>
</li>
<li><p>间接递归</p>
<p> $A\rightarrow B\beta$</p>
<p> $B\rightarrow A\alpha, A,B\in V_N, \alpha, \beta\in V^*$</p>
</li>
</ol>
<p><strong>左递归消除</strong></p>
<p>$P\rightarrow P\alpha_1|P\alpha_2|…|P\alpha_m|\beta_1|\beta_2|…|\beta_n$</p>
<p>改写为</p>
<p>$P\rightarrow\beta_1 P’|\beta_2 P’|…|\beta_n P’$</p>
<p>$P’\rightarrow\alpha_1 P’|\alpha_2 P’|…|\alpha_m P’|\varepsilon$</p>
<h3 id="FIRST-FOLLOW"><a href="#FIRST-FOLLOW" class="headerlink" title="FIRST, FOLLOW"></a>FIRST, FOLLOW</h3><p>终结首符集: $FIRST(\alpha)={a|\alpha\Rightarrow^<em>a…,a\in V_T}, \特别地, 如果\alpha\Rightarrow^</em>\varepsilon, 则规定\varepsilon\in FIRST(\alpha)$</p>
<p>后继终结符号集: $FOLLOW(A)={a|S\Rightarrow^<em>…Aa…,a\in V_T}, \特别地, 如果S\Rightarrow^</em>…A, 则规定#\in FOLLOW(S)$</p>
<h3 id="LL-1-文法"><a href="#LL-1-文法" class="headerlink" title="LL(1)文法"></a>LL(1)文法</h3><p>可以进行无回溯的自上而下分析</p>
<ul>
<li>不含左递归</li>
<li>产生式右侧的所有非终结符的FIRST集无交集<ul>
<li>$A\rightarrow\alpha_1|\alpha_2|…|\alpha_n\Rightarrow FIRST(\alpha_i)\cap FIRST(\alpha_j)=\Phi, (i\neq j)$</li>
</ul>
</li>
<li>若$\varepsilon\in FIRST(A)$, 则$FIRST(A)\cap FOLLOW(A)=\Phi$</li>
</ul>
<h3 id="LL-1-分析方法"><a href="#LL-1-分析方法" class="headerlink" title="LL(1)分析方法"></a>LL(1)分析方法</h3><ul>
<li>当前输入符号为$a$, 要匹配一个$A$, 且$A\rightarrow\alpha_1|\alpha_2|…|\alpha_n$</li>
<li>若$a\in FIRST(\alpha_i$)集合, 则直接匹配$A\rightarrow\alpha_i$</li>
<li>若$\varepsilon\in FIRST(A)$, 但是$a\in FOLLOW(A)$中, 仍可以匹配</li>
<li>否则报错</li>
</ul>
<h3 id="LL-1-程序构造"><a href="#LL-1-程序构造" class="headerlink" title="LL(1)程序构造"></a>LL(1)程序构造</h3><h4 id="递归下降程序"><a href="#递归下降程序" class="headerlink" title="递归下降程序"></a>递归下降程序</h4><ul>
<li>每个递归过程对应一个非终结符</li>
</ul>
<h4 id="预测分析程序"><a href="#预测分析程序" class="headerlink" title="预测分析程序"></a>预测分析程序</h4><p>使用分析表和符号栈实现LL(1)分析</p>
<p>需要预先构造分析表</p>
<p>略</p>
<h2 id="规范规约"><a href="#规范规约" class="headerlink" title="规范规约"></a>规范规约</h2><p><strong>短语</strong>: </p>
<ul>
<li>$对于文法G, 开始符号S, 若\alpha\beta\delta是一个句型, 如果S\Rightarrow^*\alpha A\delta且A\Rightarrow^+\beta, 则称\beta是句型\alpha\beta\delta相对于A的短语$</li>
<li>$句型语法树中每棵子树的所有叶子结点左右到右排列起来构成一个该句型相对于子树根(A)的短语$</li>
</ul>
<p><strong>直接短语</strong>: </p>
<ul>
<li>$A\Rightarrow\beta$</li>
<li>$只有父子两代的子树形成的短语, 一步推导出终结符的子树$</li>
</ul>
<p><strong>句柄</strong>:</p>
<ul>
<li>$一个句型的最左直接短语$</li>
<li>$语法树中最左的只有父子两代的子树形成的短语$</li>
</ul>
<p><img src="parser/phrase.png" alt=""></p>
<p>句型<code>E+T*F</code>的</p>
<ul>
<li>短语为<code>E+T*F</code>(相对于E), <code>T*F</code>(相对于T)</li>
<li>直接短语为<code>T*F</code></li>
<li>句柄为<code>T*F</code></li>
</ul>
<h2 id="算符优先分析法"><a href="#算符优先分析法" class="headerlink" title="算符优先分析法"></a>算符优先分析法</h2><h3 id="算符优先文法"><a href="#算符优先文法" class="headerlink" title="算符优先文法"></a>算符优先文法</h3><p>算符文法: 任一产生式的右部都不包含两个<strong>相继(并列)的非终结符</strong></p>
<p>最多一个优先关系: 对任何一对终结符, (a,b)最多满足一个优先关系</p>
<p>算符优先文法: 满足最多一个优先关系的算符文法</p>
<h3 id="优先关系表"><a href="#优先关系表" class="headerlink" title="优先关系表"></a>优先关系表</h3><p>优先关系的表格</p>
<h3 id="FIRSTVT-LASTVT"><a href="#FIRSTVT-LASTVT" class="headerlink" title="FIRSTVT, LASTVT"></a>FIRSTVT, LASTVT</h3><p>$FIRSTVT(P)={a|P\Rightarrow^+a…或P\Rightarrow^+Qa…, a\in V_T而Q\in V_N}$</p>
<p>$LASTVT(P)={a|P\Rightarrow^+…a或P\Rightarrow^+…Qa, a\in V_T而Q\in V_N}$</p>
<h3 id="素短语"><a href="#素短语" class="headerlink" title="素短语"></a>素短语</h3><p>素短语: 至少含有一个终结符, 而且除它自身以外不含有任何更小的素短语</p>
<p>最左素短语: 句型最左边的素短语</p>
<h2 id="LR分析法"><a href="#LR分析法" class="headerlink" title="LR分析法"></a>LR分析法</h2><p>L: 从左到右扫描输入串<br>R: 构造最右推导的逆过程<br>LR分析法是严格的规范规约</p>
<p>原理: 在移进-规约过程中寻找句柄</p>
<p>模型: </p>
<ul>
<li>将历史和展望抽象成状态, 整体上是一个FA</li>
<li>一张分析表<ul>
<li>ACTION[s,a]: 状态s遇到输入a应该采取什么动作</li>
<li>GOTO[s,X]: 状态s遇到文法符号X时下一状态是什么, 构成了一个以文法符号为字母表的DFA</li>
</ul>
</li>
</ul>
<p>分类:</p>
<ul>
<li>总控程序: 所有的LR分析器都相同</li>
<li>分析表: 是自动生成语法分析器的关键<ul>
<li>LR(0)表: 基础但有局限性</li>
<li>SLR表: 简单LR表, 实用</li>
<li>规范LR表: 能力强, 代价大</li>
<li>LALR表: 向前LR表, 介于SLR和规范LR之间</li>
</ul>
</li>
</ul>
<p>ACTION表:</p>
<ol>
<li>移进$sN$: 将$N$和输入符号$a$进栈, 读取下一个输入</li>
<li>规约$rN$: 用$N$号产生式$A\Rightarrow\beta$进行规约, 出栈$|\beta|$项, 将$GOTO[s.top, A]$和$A$进栈(规约), <strong>输入不动</strong></li>
<li>接受$acc$: 分析成功结束</li>
<li>报错</li>
</ol>
<p>LR文法: 能够构造LR分析表, 使得每个入口都是唯一确定的文法</p>
<p>LR(k)文法: 每步至多向前检查k个输入符号就能用LR分析器进行分析的文法</p>
<ul>
<li>大多数PL符合LR(1)文法</li>
<li>k=0表示不需要展望</li>
</ul>
<h3 id="LR-0"><a href="#LR-0" class="headerlink" title="LR(0)"></a>LR(0)</h3><p>LR(0)项目: 在文法产生式右部中间间隔处加一个圆点</p>
<ul>
<li>指明了在分析过程的某一时刻看到了产生式的多大部分</li>
</ul>
<p>活前缀: 规范句型的最多到句柄(可以包括句柄)的前缀</p>
<ul>
<li>LR分析时栈里的符号应该始终构成活前缀</li>
</ul>
<h4 id="1-识别活前缀的NFA方法"><a href="#1-识别活前缀的NFA方法" class="headerlink" title="1. 识别活前缀的NFA方法:"></a>1. 识别活前缀的NFA方法:</h4><ul>
<li>只有项目1作为初态, 其他任何项目都认为是终态</li>
<li>连接非$\varepsilon$弧<ul>
<li>$状态i为X\rightarrow X<em>1…X</em>{i-1}\cdot X_i…X_n$</li>
<li>$状态j为X\rightarrow X<em>1…X</em>{i-1}X<em>i\cdot X</em>{i+1}…X_n$</li>
<li>则连接状态$i$到状态$j$, 标志为$X_i$</li>
</ul>
</li>
<li><p>连接$\varepsilon$弧</p>
<ul>
<li>$状态i为X\rightarrow \alpha\cdot A\beta$</li>
<li>则连接状态$i$到所有状态$A\rightarrow\cdot\gamma$, 标志为$\varepsilon$</li>
</ul>
<p><img src="parser/huoqianzhui.png" alt=""></p>
</li>
<li><p>确定化(NFA转DFA)</p>
<ul>
<li>(也可以直接看出来)</li>
</ul>
<p><img src="parser/huoqianzhui2.png" alt=""></p>
</li>
</ul>
<h4 id="2-LR-0-项目集规范族"><a href="#2-LR-0-项目集规范族" class="headerlink" title="2. LR(0)项目集规范族"></a>2. LR(0)项目集规范族</h4><ul>
<li><p>识别活前缀的DFA的项目集的全体称为文法的LR(0)项目集规范族</p>
<ul>
<li>规约项目: $A\rightarrow\alpha\cdot$</li>
<li>接受项目: $S\rightarrow\alpha\cdot$</li>
<li>移进项目: $A\rightarrow\alpha\cdot a\beta$</li>
<li>待约项目: $A\rightarrow\alpha\cdot B\beta$</li>
</ul>
</li>
<li><p>拓广文法</p>
<ul>
<li>构造一个新的文法$G’\supseteq G$</li>
<li>引进一个开始符号, 非终结符$S’$</li>
<li>增加一个产生式$S’\rightarrow S$</li>
<li>唯一接受态: $S’\rightarrow S\cdot$</li>
</ul>
</li>
<li>项目集的闭包$Closure(I)$:<ul>
<li>$I\in Closure(I)$</li>
<li>若$(A\rightarrow\alpha\cdot B\beta)\in Closure(I)$, 则对于任何$B\rightarrow\gamma$, $(B\rightarrow\cdot\gamma)\in Closure(I)$</li>
<li>与$I$同状态的项目集合, 包括子项目</li>
</ul>
</li>
<li>状态转换函数$GO(I,X)$:<ul>
<li>$GO(I, X)=Closure({A\rightarrow\alpha X\cdot\beta|(A\rightarrow\alpha\cdot X\beta)\in I})$</li>
<li>若$I$是对活前缀$\gamma$有效的项目集, 那么$GO(I, X)$就是对$\gamma X$有效的项目集</li>
<li>(接受$X$之后的$Closure$集合)</li>
</ul>
</li>
<li>构造DFA算法 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PROCEDURE ITEMSETS(G&#39;)</span><br><span class="line">BEGIN</span><br><span class="line">  C:&#x3D;&#123;Closure(&#123;S&#39;\rightarrow\cdot S&#125;)&#125;</span><br><span class="line">  REPEAT</span><br><span class="line">    FOR C中每个项目集I和G&#39;的每个符号X DO</span><br><span class="line">      IF GO(I, X)非空且不属于C THEN</span><br><span class="line">        C +&#x3D; GO(I, X)</span><br><span class="line">  UNTIL C 不再增大</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>LR(0)文法:</p>
<ul>
<li>拓广文法的识别活前缀的dfa的项目集(LR(0)项目集规范族)不包含任何<strong>冲突</strong>的文法</li>
</ul>
<p>冲突</p>
<ul>
<li>既含移进项目又含规约项目 <ul>
<li><code>E-&gt;E·*E</code></li>
<li><code>E-&gt;E+E·</code></li>
</ul>
</li>
<li>含有多个规约项目 <ul>
<li><code>P-&gt;A·</code></li>
<li><code>Q-&gt;A·</code></li>
</ul>
</li>
</ul>
<p>构造LR(0)分析表:</p>
<ul>
<li>每个项目集为一个状态</li>
<li>包含$S’\rightarrow\cdot S$的集合为初态</li>
</ul>
<p><strong>构造LR(0)的ACTION和GOTO</strong>:</p>
<ul>
<li>若$(A\rightarrow\alpha\cdot a\beta)\in I_k$且$GO(I_k, a)=I_j$, 则$ACTION[k, a]=sj$</li>
<li>若$(A\rightarrow\alpha\cdot)\in I_k$, 则$ACTION[k, a]=rj$</li>
<li>若$(S’\rightarrow S)\in I_k$, 则$ACTION[k, a]=acc$</li>
<li>若$GO(I_k,A)=I_j$, 则$GOTO[k, a]=j$</li>
<li>其他均为报错</li>
</ul>
<p><img src="parser/lr0_table.png" alt=""></p>
<h3 id="SLR"><a href="#SLR" class="headerlink" title="SLR"></a>SLR</h3><p>LR(0)可能会误判: 即使存在项目冲突, 也不一定不合法</p>
<p>假定LR(0)规范族的一个项目集</p>
<script type="math/tex; mode=display">
\begin{aligned}
I=\{
&A_1\rightarrow\alpha\cdot a_1\beta_1,\\
&A_2\rightarrow\alpha\cdot a_2\beta_2,\\
&...\\
&A_m\rightarrow\alpha\cdot a_m\beta_m,\\ 
&B_1\rightarrow\alpha\cdot,\\
&B_2\rightarrow\alpha\cdot,\\
&...\\
&B_n\rightarrow\alpha\cdot\}
\end{aligned}</script><p>如果集合${a_1, …, a_m}, FOLLOW(B_1), …, FOLLOW(B_n)$两两不相交(包括不得有两个FOLLOW集合有#), 则</p>
<ol>
<li>若a是某个ai, i=1,2,…,m, 则移进</li>
<li>若$a\in FOLLOW(B_i), i=1,2,…,n$, 则用产生式$B_i\rightarrow\alpha$进行归约</li>
<li>此外, 报错。</li>
</ol>
<p>冲突性动作的这种解决办法叫做SLR(1)解决办法。上述方法构造出的ACTION与GOTO表如果不含多重入口，则称该文法为<strong>SLR(1)文法</strong></p>
<h3 id="LR-1"><a href="#LR-1" class="headerlink" title="LR(1)"></a>LR(1)</h3><h3 id="LALR"><a href="#LALR" class="headerlink" title="LALR"></a>LALR</h3><p>不考, 略</p>
<h2 id="二义文法的应用"><a href="#二义文法的应用" class="headerlink" title="二义文法的应用"></a>二义文法的应用</h2><h3 id="二义文法"><a href="#二义文法" class="headerlink" title="二义文法"></a>二义文法</h3><ul>
<li>不是LR文法</li>
<li>简洁、自然</li>
<li>可以用文法以外的信息来消除二义</li>
<li>语法分析的效率高（基于消除二义后得到的分析表）</li>
</ul>
<p>举例: E → E + E | E * E | (E) | id</p>
<p>消除二义性:</p>
<ol>
<li>使用文法以外信息来解决分析动作冲突</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/compiler-principle/lex.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/compiler-principle/lex.html" class="post-title-link" itemprop="url">词法分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-17 10:54:12" itemprop="dateCreated datePublished" datetime="2020-12-17T10:54:12+08:00">2020-12-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">编译原理</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/compiler-principle/lex.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="compiler-principle/lex.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="提纲"><a href="#提纲" class="headerlink" title="提纲"></a>提纲</h2><p><img src="lex/index.png" alt=""></p>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><ul>
<li>单词级别分析和翻译源程序</li>
<li>任务: 作为<strong>字符串</strong>的源程序-&gt;<strong>单词符号串</strong></li>
</ul>
<h2 id="词法分析器的要求"><a href="#词法分析器的要求" class="headerlink" title="词法分析器的要求"></a>词法分析器的要求</h2><p>单词符号表示通常使用二元式 (单词种别, 单词符号的属性值)</p>
<ul>
<li>单词种别: 语法分析需要的信息, 通常使用整数编码</li>
<li>单词(符号属性)值: 编译其他阶段使用</li>
</ul>
<p>单词如何分类取决于处理上的方便:</p>
<ul>
<li>标识符: 一般通归为一种</li>
<li>常数: 按类型分种</li>
<li>关键字: 可全体为一种, 也可一字一种(更方便)</li>
<li>运算符: 一般一符一种, 可以把具有一定共性的视为一类</li>
<li>界符: 一般一符一种</li>
</ul>
<p>单词符号的属性:</p>
<ul>
<li>标识符: 存放它<strong>符号表</strong>项的指针/内部字符串</li>
<li>常数: 存放它<strong>常数表</strong>项的指针/二进制形式</li>
<li>关键字/运算符/界符: 不需要属性</li>
</ul>
<p><img src="lex/lex.png" alt=""></p>
<p>实现方式:</p>
<ul>
<li>完全独立: lex作为单独一遍<ul>
<li>结构简洁, 清晰, 条理化</li>
</ul>
</li>
<li>相对独立: 作为parser的一个独立子程序, 需要新符号时调用<ul>
<li>避免中间文件, 提高效率</li>
</ul>
</li>
</ul>
<h2 id="词法分析器设计"><a href="#词法分析器设计" class="headerlink" title="词法分析器设计"></a>词法分析器设计</h2><h3 id="lexer的结构"><a href="#lexer的结构" class="headerlink" title="lexer的结构"></a>lexer的结构</h3><p>源程序 -&gt; 输入缓冲区/预处理子程序/扫描缓冲区/扫描器 -&gt; 单词符号</p>
<p>预处理子程序: 处理空白符等编辑性字符, 删除注释等</p>
<p>输入缓冲区: 存放源程序文本输入串的缓冲区</p>
<p>扫描缓冲区: 设定两个指示器</p>
<h3 id="单词符号的识别-超前搜索"><a href="#单词符号的识别-超前搜索" class="headerlink" title="单词符号的识别: 超前搜索"></a>单词符号的识别: 超前搜索</h3><ul>
<li>关键字识别</li>
<li>标识符识别: 一般是字母开头的字母数字串, 一般都跟着算符或者界符, 不难识别</li>
<li>常数的识别: 有些语言需要使用超前搜索</li>
<li>算符和界符: 对于c++中的++,—等需要超前搜索</li>
</ul>
<h3 id="词法规则的表示"><a href="#词法规则的表示" class="headerlink" title="词法规则的表示"></a>词法规则的表示</h3><p>大多数pl中的单词符号的<strong>词法规则</strong>可以用<strong>正规文法</strong>描述</p>
<p>例如:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;标识符&gt; -&gt; 字母|&lt;标识符&gt;字母|&lt;标识符&gt;数字</span><br><span class="line">&lt;整数&gt; -&gt; 数字|&lt;整数&gt;数字</span><br><span class="line">&lt;运算符&gt; -&gt; +|-|×|÷…</span><br><span class="line">&lt;界符&gt; -&gt; ;|,|(|)|…</span><br></pre></td></tr></table></figure>
<p>利用这些规则识别的过程可以用<strong>状态转换图</strong>来表示, 而状态转换图可以方便地用程序实现</p>
<h3 id="TG"><a href="#TG" class="headerlink" title="TG"></a>TG</h3><p>状态转换图TG: 一个有限有向图, 可用于接受(识别)一定的符号串</p>
<ul>
<li>结点表示状态, 用圆圈表示<ul>
<li>初态: 通常只有一个, 用一条输入弧表示</li>
<li>终态: <strong>至少有一个</strong>, 用双圈表示</li>
</ul>
</li>
<li>方向弧表示状态转换, 弧上的标记表示接受的输入字符或字符类</li>
</ul>
<p>路: 在状态转换图中从初态到某一个终态的弧上的标记序列</p>
<p>接受(识别): 若存在一条路产生$\beta$, 则称状态转换图接受符号串$\beta$</p>
<p>状态转换图能识别的语言: L(TG)能别TG接受的符号串的集合</p>
<p><img src="lex/tg.png" alt=""></p>
<h2 id="正规表达式和有限自动机"><a href="#正规表达式和有限自动机" class="headerlink" title="正规表达式和有限自动机"></a>正规表达式和有限自动机</h2><h3 id="正规式"><a href="#正规式" class="headerlink" title="正规式"></a>正规式</h3><p>字母表$\Sigma$上的正规式和正规集递归定义如下：</p>
<ol>
<li>$\varepsilon$和$\varphi$都是$\Sigma$上的正规式, 它们所表示的正规集分别为${\varepsilon}$和$\varphi$。其中：$\varepsilon$为空字符串, $\varphi$为空集</li>
<li>任意元素$a\in\Sigma$, a是$\Sigma$上的一个正规式, 它所表示的正规集是${a}$;</li>
<li>假定U和V都是$\Sigma$上的正规式, 它们所表示的正规集记为L(U)和L(V), 那么(U|V), (U·V)和(U)*都是正规式, 他们所表示的正规集分别记为L(U)∪L(V), L(U)L(V)和(L(U))*。</li>
<li>仅由有限次使用上述三步而得到的表达式才是$\Sigma$上的正规式, 它们所表示的字集才是$\Sigma$上的正规集。</li>
</ol>
<p>运算:</p>
<ul>
<li>闭包<code>*</code></li>
<li>连接<code>.</code> (可省略)</li>
<li>或<code>|</code></li>
</ul>
<p>运算律:</p>
<ul>
<li>或交换律</li>
<li>或结合律</li>
<li>连接结合律</li>
<li>或对连接分配律</li>
<li>$\varepsilon U=U \varepsilon=U$</li>
</ul>
<p>例:</p>
<ul>
<li>以01结尾的二进制数串的正规式: <code>(0|1)*01</code></li>
<li>能被5整除的十进制整数: <code>0|5|(1|2|3|4|5|6|7|8|9)(0|1|2|3|4|5|6|7|8|9)*(0|5)</code></li>
</ul>
<h3 id="FA"><a href="#FA" class="headerlink" title="FA"></a>FA</h3><p>自动机: 具有离散输入输出的数学模型</p>
<pre><code>状态 + 输入 + 规则 -&gt; 状态迁移
</code></pre><p>有限自动机(FA)</p>
<p>有限状态机(FSM)</p>
<h3 id="DFA"><a href="#DFA" class="headerlink" title="DFA"></a>DFA</h3><p>DFA五元组: $M=(S,\Sigma,\delta,S_0,F)$</p>
<ul>
<li>$S$: 有限的状态集合, 每个元素称为一个状态</li>
<li>$\Sigma$: 有限的输入字母表, 每个元素称为一个输入字符</li>
<li>$\delta: S\times\Sigma \rightarrow S$: 转换函数(状态转移集合)<ul>
<li>$\delta(s, a)=s’$</li>
</ul>
</li>
<li>$S_0\in S$: 初始状态</li>
<li>$F\subseteq S$: 终止状态集</li>
</ul>
<p>状态转换矩阵: DFA可以用一个矩阵表示, 每行表示一个状态, 每列表示一种输入, 矩阵元素表示$\delta(s,a)$的值</p>
<p><strong>DFA与状态转换图: DFA可以用TG唯一表示</strong></p>
<p><img src="lex/dfa_tg.png" alt=""></p>
<p><strong>拓展转移函数</strong></p>
<ul>
<li>接收一个字符串的状态转移函数</li>
<li>$\delta’: S\times\Sigma^* \rightarrow S$<ul>
<li>$\delta’(s, \varepsilon) = s$</li>
<li>$\delta’(s, \omega a) = \delta(\delta’(s,\omega),a)$</li>
</ul>
</li>
</ul>
<p>DFA接受的字符串</p>
<p>DFA接受的语言: $L(M)={α|\delta’(s,α)\in F}$</p>
<h3 id="NFA"><a href="#NFA" class="headerlink" title="NFA"></a>NFA</h3><p>NFA五元组: $M=(S,\Sigma,\delta,S_0,F)$</p>
<ul>
<li>$S$: 同DFA</li>
<li>$\Sigma$: 同DFA</li>
<li>$\delta: S\times\Sigma^* \rightarrow 2^S(幂集)$: 转换函数(状态转移集合)<ul>
<li>$\delta(s, a)=S’\subseteq S$</li>
</ul>
</li>
<li>$S_0\subseteq S$: 非空初态集</li>
<li>$F\subseteq S$: 终止状态集</li>
</ul>
<p><strong>NFA也可以用TG和转换矩阵表示</strong></p>
<p><strong>NFA的状态是一个集合</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>比较</th>
<th>DFA</th>
<th>NFA</th>
</tr>
</thead>
<tbody>
<tr>
<td>输入字母</td>
<td>每个(状态,输入)都有一个$\delta$</td>
<td>可能没有$\delta$/是空转换</td>
</tr>
<tr>
<td>转移状态</td>
<td>确定的</td>
<td>不确定的, 可能有多个</td>
</tr>
</tbody>
</table>
</div>
<p>NFA的拓展转移函数</p>
<ul>
<li>$\delta’: S\times\Sigma^* \rightarrow 2^S$<ul>
<li>$\delta’(s, \varepsilon) = {s}$</li>
<li>$\delta’(s,\omega a)={p|存在r\in\delta’(s,\omega )\wedge p\in\delta(r,a)}$</li>
</ul>
</li>
</ul>
<p>NFA接受的字符串</p>
<p>NFA接受的语言</p>
<h3 id="DFA和NFA的关系-子集法"><a href="#DFA和NFA的关系-子集法" class="headerlink" title="DFA和NFA的关系 (子集法)"></a>DFA和NFA的关系 (子集法)</h3><p>DFA是NFA的特例, 两者可以相互转化</p>
<p><strong>ε-闭包</strong>:</p>
<script type="math/tex; mode=display">
\varepsilon\_CLOSURE(I)=I\cup\{q'|q经任意条\varepsilon弧可到达q', q\in I\}, I\subseteq M'</script><p><strong>NFA-&gt;DFA之子集法</strong>:</p>
<ol>
<li>引进新的初态结点X和终态结点Y, 从X到所有原始态结点连接一条$\varepsilon$弧, 从所有原终态结点到Y连接一条$\varepsilon$弧</li>
<li><p>对复合的弧进行<strong>分裂</strong></p>
<p> <img src="lex/nfa_dfa.png" alt=""> </p>
</li>
<li><p>构造状态矩阵<br> | I                           | $I_{\Sigma_i}$ | … |<br> | —————————————- | ——————— | —- |<br> | $\varepsilon_CLOSURE({X})$ | …            | … |<br> | …                         | …            | … |</p>
</li>
<li><p>合并相同状态, 重新命名得到新的状态转换矩阵</p>
<ul>
<li>第一行第一列的状态为始态</li>
<li>包含Y的状态为终态</li>
</ul>
</li>
<li>画出状态转换图</li>
</ol>
<p>例:</p>
<p><img src="lex/nfa_dfa_example_1.png" alt=""></p>
<p><img src="lex/nfa_dfa_example_2.png" alt=""></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>I</th>
<th>$I_{a}$</th>
<th>$I_{b}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>{X, 0, Y}</td>
<td>{1}</td>
<td>{1}</td>
</tr>
<tr>
<td>{1}</td>
<td>{0,Y}</td>
<td>-</td>
</tr>
<tr>
<td>{0,Y}</td>
<td>{1}</td>
<td>{1}</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>I</th>
<th>$I_{a}$</th>
<th>$I_{b}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>-</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
<p><img src="lex/nfa_dfa_example_3.png" alt=""></p>
<h3 id="正规式和FA的关系"><a href="#正规式和FA的关系" class="headerlink" title="正规式和FA的关系"></a>正规式和FA的关系</h3><ul>
<li>正规式和FA是等价的</li>
</ul>
<h4 id="从NFA构造等价的正规式-简单"><a href="#从NFA构造等价的正规式-简单" class="headerlink" title="从NFA构造等价的正规式 (简单)"></a>从NFA构造等价的正规式 (简单)</h4><ol>
<li><p>引进新的初态结点X和终态结点Y, 从X到所有原始态结点连接一条$\varepsilon$弧, 从所有原终态结点到Y连接一条$\varepsilon$弧</p>
</li>
<li><p>对复合的弧进行<strong>合并</strong></p>
<p> <img src="lex/nfa_regex.png" alt=""></p>
</li>
<li><p>得到regex</p>
</li>
</ol>
<h4 id="从正规式构造等价的NFA-Thompson算法"><a href="#从正规式构造等价的NFA-Thompson算法" class="headerlink" title="从正规式构造等价的NFA (Thompson算法)"></a><strong>从正规式构造等价的NFA (Thompson算法)</strong></h4><p><img src="lex/regex_nfa_1.png" alt=""><br><img src="lex/regex_nfa_2.png" alt=""></p>
<p>例:</p>
<p><img src="lex/regex_nfa_example.png" alt=""></p>
<h3 id="DFA的化简-等价状态法"><a href="#DFA的化简-等价状态法" class="headerlink" title="DFA的化简 (等价状态法)"></a><strong>DFA的化简 (等价状态法)</strong></h3><p>将状态集$S$根据能否被输入区分划分为更细的集合</p>
<ol>
<li>初始划分: $\Pi={终态集I^{(1)}, 非终态集I^{(2)}}$</li>
<li>检查能否再分<ol>
<li>如果对输入字符$a$, 存在$I^{(k)}$接受$a$后不全落在现行$\Pi$的某一个子集中</li>
<li>就把$I^{(k)}$分成多个组, 使得每个组接受$a$后都落在$\Pi$的同一个子集中</li>
</ol>
</li>
<li>重复直到子集数不再增加</li>
</ol>
<p><img src="lex/dfa_simplify.png" alt=""></p>
<p>例题:</p>
<p><img src="lex/dfa_simplify_example.png" alt=""></p>
<p>初始划分$\Pi_0={\left{A,B,C,D\right},{E}}$</p>
<p>考察${A,B,C,D}_a={B}\subseteq {A,B,C,D}$</p>
<p>${A,B,C,D}_b={C,D,E}$, 需要划分, 其中${A,B,C}_b={C,D}$, ${D}_b={E}$</p>
<p>将${A,B,C,D}$分成${A,B,C}$和${D}$, 得$\Pi_1={\left{A,B,C\right},{D},{E}}$</p>
<p>考察${A,B,C}_b={C,D}$, 需要划分, 其中${A,C}_b={C}$, ${B}_b={D}$</p>
<p>将${A,B,C}$分为${A,C}$和${B}$, 得$\Pi_2={\left{A,C\right},{B},{D},{E}}$</p>
<h3 id="正规文法和FA的关系"><a href="#正规文法和FA的关系" class="headerlink" title="正规文法和FA的关系"></a>正规文法和FA的关系</h3><p>FA和左(右)线性正规文法等价</p>
<p>将FA的状态和右线性正规文法的非终结符作为桥梁, 两者等价</p>
<h2 id="词法分析器的自动生成"><a href="#词法分析器的自动生成" class="headerlink" title="词法分析器的自动生成"></a>词法分析器的自动生成</h2><p>略</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/PTA/1099.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/PTA/1099.html" class="post-title-link" itemprop="url">1099. Build A Binary Search Tree</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-16 15:13:24" itemprop="dateCreated datePublished" datetime="2020-12-16T15:13:24+08:00">2020-12-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/PTA/" itemprop="url" rel="index"><span itemprop="name">PTA</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/PTA/1099.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="PTA/1099.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>给出二叉树结构和节点的值列表, 将值填入二叉树中, 输出层次序遍历的结果</p>
<p>考点: 二叉树的直接后继</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _DEBUG</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span> <span class="function"><span class="keyword">void</span> <span class="title">ERR</span><span class="params">(T x, <span class="built_in">string</span> name)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[DEBUG]&#123;&quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;&#125; = &quot;</span> &lt;&lt; x &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#    <span class="meta-keyword">define</span> debug(x) ERR(x, #    x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#    <span class="meta-keyword">define</span> debug(...) 0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    <span class="keyword">int</span> left, right, parent;</span><br><span class="line">&#125; N[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _DEBUG</span></span><br><span class="line">    freopen(__FILE__ <span class="string">&quot;.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="comment">// freopen(__FILE__ &quot;.out&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> first = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    N[<span class="number">0</span>].parent = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> l, r;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r;</span><br><span class="line">        N[i].left = l;</span><br><span class="line">        N[l].parent = i;</span><br><span class="line">        N[i].right = r;</span><br><span class="line">        N[r].parent = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vals;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; val;</span><br><span class="line">        vals.push_back(val);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(vals.begin(), vals.end());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (N[p].left != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (N[p].left != <span class="number">-1</span>)</span><br><span class="line">            p = N[p].left;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (p != <span class="number">-1</span>) &#123;</span><br><span class="line">        debug(p);</span><br><span class="line">        N[p].val = vals.front();</span><br><span class="line">        vals.erase(vals.begin());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (N[p].right != <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="comment">// right down</span></span><br><span class="line">            p = N[p].right;</span><br><span class="line">            <span class="keyword">while</span> (N[p].left != <span class="number">-1</span>) &#123;</span><br><span class="line">                p = N[p].left;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (N[p].parent != <span class="number">-1</span> &amp;&amp; N[N[p].parent].left == p) &#123;</span><br><span class="line">            <span class="comment">// right up</span></span><br><span class="line">            p = N[p].parent;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (N[p].parent != <span class="number">-1</span> &amp;&amp; N[N[p].parent].right == p) &#123;</span><br><span class="line">                p = N[p].parent;</span><br><span class="line">            &#125;</span><br><span class="line">            p = N[p].parent;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">    Q.push(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (Q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> top = Q.front();</span><br><span class="line">        Q.pop();</span><br><span class="line">        <span class="keyword">if</span> (!first)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            first = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; N[top].val;</span><br><span class="line">        <span class="keyword">if</span> (N[top].left != <span class="number">-1</span>)</span><br><span class="line">            Q.push(N[top].left);</span><br><span class="line">        <span class="keyword">if</span> (N[top].right != <span class="number">-1</span>)</span><br><span class="line">            Q.push(N[top].right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/leetcode/10.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/leetcode/10.html" class="post-title-link" itemprop="url">10. 正则表达式匹配</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-16 12:41:49" itemprop="dateCreated datePublished" datetime="2020-12-16T12:41:49+08:00">2020-12-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/leetcode/" itemprop="url" rel="index"><span itemprop="name">leetcode</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/leetcode/10.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="leetcode/10.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>实现支持.和*的正则表达式匹配.</p>
<p>思路: 动态规划</p>
<p>用 $f[i][j]$ 表示$s$中的前 $i$ 个字母能否与 $p$ 中的前 $j$ 个字母匹配, 按照$p[j]$是否为*分为两种情况</p>
<p>存在*时的转移方程可以这样考虑: </p>
<ol>
<li><p>匹配 s 末尾的一个字符，将该字符扔掉，而该组合还可以继续进行匹配；($f[i-1][j]$)</p>
</li>
<li><p>不匹配字符，将该组合扔掉，不再进行匹配。($f[i][j - 2]$)</p>
</li>
</ol>
<p>最终的状态转移方程:</p>
<script type="math/tex; mode=display">
f[i][j] = \begin{cases}
f[i - 1][j - 1], & p[j] \neq '*' ~and~ s[i] = p[j] \\
false, & p[j] \neq '*' ~and~ s[i] \neq p[j] \\
f[i][j - 2] ~or~ f[i-1][j], & p[j] = '*' ~and~ s[i] = p[j-1] \\
f[i][j - 2], & p[j] = '*' ~and~ s[i] \neq p[j-1]
\end{cases}</script><p>代码:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isMatch</span><span class="params">(<span class="built_in">string</span> s, <span class="built_in">string</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = s.size();</span><br><span class="line">        <span class="keyword">int</span> n = p.size();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> matches = [&amp;](<span class="keyword">int</span> i, <span class="keyword">int</span> j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (p[j - <span class="number">1</span>] == <span class="string">&#x27;.&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> s[i - <span class="number">1</span>] == p[j - <span class="number">1</span>];</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; f(m + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>));</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (p[j - <span class="number">1</span>] == <span class="string">&#x27;*&#x27;</span>) &#123;</span><br><span class="line">                    f[i][j] |= f[i][j - <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (matches(i, j - <span class="number">1</span>)) &#123;</span><br><span class="line">                        f[i][j] |= f[i - <span class="number">1</span>][j];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (matches(i, j)) &#123;</span><br><span class="line">                        f[i][j] |= f[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f[m][n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://frezcirno.github.io/leetcode/290.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.7c00h.xyz/avatar.jpg">
      <meta itemprop="name" content="frezcirno">
      <meta itemprop="description" content="Frezcirno的个人博客, 记录一些技术相关的学习内容">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Frezcirno's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/leetcode/290.html" class="post-title-link" itemprop="url">290. 单词规律</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-16 11:54:45" itemprop="dateCreated datePublished" datetime="2020-12-16T11:54:45+08:00">2020-12-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/leetcode/" itemprop="url" rel="index"><span itemprop="name">leetcode</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/leetcode/290.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="leetcode/290.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>判断给定<em>字符串</em>是不是按照给定<em>模式</em>的短语, 例如”dog dog cat cat”就是”aabb”式的短语</p>
<p>思路: 用map记录模式字母与单词的对应关系, 如果发现不一致, 返回false, 否则返回true</p>
<p>注意: 模式中不同字母对应的单词不能相同</p>
<p>提示: </p>
<p>按照key查询map可以使用map自带的find()函数</p>
<p>按照value查询map可以使用find_if()函数</p>
<p>两者都返回迭代器</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M.find(someKey);</span><br><span class="line">find_if(M.begin(), M.end(), [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; kv)&#123; <span class="comment">/* ... */</span> &#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">wordPattern</span><span class="params">(<span class="built_in">string</span> pattern, <span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">map</span>&lt;<span class="keyword">char</span>, <span class="built_in">string</span>&gt; M;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; S;</span><br><span class="line">        <span class="keyword">char</span> *p = strtok((<span class="keyword">char</span> *)s.c_str(), <span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (p) <span class="keyword">do</span> &#123;</span><br><span class="line">            S.push_back(p);</span><br><span class="line">        &#125; <span class="keyword">while</span> (p = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pattern.size() != S.size()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pattern.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">char</span> ch = pattern[i];</span><br><span class="line">            <span class="keyword">if</span> (M.find(ch) == M.end()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (find_if(M.begin(),M.end(),[&amp;](<span class="keyword">const</span> <span class="keyword">auto</span>&amp;p)&#123;<span class="keyword">return</span> p.second==S[i];&#125;)!=M.end())&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">cout</span>&lt;&lt;ch&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;S[i]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">                M[ch] = S[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (M[ch] != S[i]) &#123;</span><br><span class="line">                <span class="built_in">cout</span>&lt;&lt;M[ch]&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;S[i]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2020 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fas fa-dove"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">frezcirno</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">157k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:22</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  

<script src="/js/local-search.js"></script>






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = '//cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://frezcirno-github-io.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<!-- <script src="https://cdn.7c00h.xyz/live2d-widget/autoload.js"></script> -->
</body>
</html>
